/*!
 * jquery.render v1.2.4
 * http://sideroad.secret.jp/
 *
 * Template render plugin
 * 
 * Copyright (c) 2011 sideroad
 *
 * Dual licensed under the MIT or GPL licenses.
 * Date: 2011-03-03
 * 
 * @author sideroad
 * @requires jQuery
 * 
 */
(function(h){var a={},c={},n="",b={},i={},g="en",d=function(r,q){if(!q.length){return r}var p=q.shift();return arguments.callee(r[p],q)},m=function(r,q,s){var p=q.shift();if(!q.length){r[p]=s;return r}else{if(!r[p]){r[p]={}}return arguments.callee(r[p],q,s)}},f=function(q){var r=Array.prototype.slice,p=r.call(arguments);p.shift();return function(){var s=r.call(arguments);return q.apply(this,p.concat(s))}},o=function(p){return String(p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e=function(s,r,t,q){var p=q.match(/\[(\d+)\]/);if(p&&p[1]){q=p[1]}return t?s[q]:o(s[q])},l=function(p,u,r,t,q){var s=(q=="val")?u:p;return t?s:o(s)},j=function(q){var p=c[g];return q.replace(/\$w\{([^\}]+)\}/g,function(s,r){return o(p[r])})},k=function(p,q){var r=p.replace(/\$\{([^\}]+)\}\.each\(\{([^\)]+)\}\)/g,function(w,u,z){var y=(u=="this")?q:d(q,u.replace(/(\[(\d+)\])/g,".$2").replace(/^\./,"").split(".")),t=0,v,s,x="";if(y instanceof Array){v=y.length;for(t=0;t<v;t++){s=y[t];x+=z.replace(/\$(r?){([^\}]+)}/g,f(e,s)).replace(/\$(r?)(val)/g,f(l,null,s))}}else{if(typeof y==="object"){for(u in y){s=y[u];x+=z.replace(/\$(r?){([^\}]+)}/g,f(e,s)).replace(/\$(r?)(val|key)/g,f(l,u,s))}}}return x}).replace(/\$(r?)\{([^\}]+)\}/g,function(t,v,s){var u=d(q,s.replace(/^this/,"").replace(/(\[(\d+)\])/g,".$2").replace(/^\./,"").split("."));return v?u:o(u)});if(b[g]){r=j(r)}return r};h.fn.render=function(q,s){var r=false,p,t;if(typeof q=="object"&&!(q instanceof String)){r=q}if(r){p=r.url+n;t=r.success;return this.each(function(){var u=h(this);if(a[p]){u.html(k(a[p],s));if(t){t()}}else{h.ajax(h.extend(true,r,{url:p,dataType:"text",success:function(v){var w=k(v,s);u.html(w);a[p]=v;if(t){t()}}}))}})}else{return this.each(function(){var u=h(this),v=k(q,s);u.html(v)})}};h.word=function(r,q,p,s){lang=p||(navigator.browserLanguage||navigator.language||navigator.userLanguage).substr(0,2);g=lang=(r[lang])?lang:(r[q])?q:"en";if(c[lang]){return}else{i[lang]=true;h.ajax({url:r[lang],dataType:"text",success:function(x){var v=x.split(/\n/),w=v.length,u,t=[];c[lang]={};for(u=0;u<w;u++){t=v[u].split(/^([^=]+)=(.+)$/);c[lang][t[1]]=t[2]}i[lang]=false;b[lang]=true;s()}})}};h.renderSuffix=function(r){r=r||{};var q=null,p=h.__render__.userAgent;for(q in r){if(r[q].test(p)){n=q}}};h.clearSuffix=function(){n=""};h.__render__={seek:d,inception:m,escapeHTML:o,word:c,userAgent:navigator.userAgent}})(jQuery);